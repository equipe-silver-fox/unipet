<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta name="theme-color" content="#8B5CF6" />
    <title>Unipet</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="../../public/style.css" />
  </head>
  <body>
    <!-- Header -->
    <div class="header">
      <div class="logo">
        <img src="../../public/img/logo.png" />
        <span>Unipet</span>
      </div>
    </div>

    <!-- Menu de Acessibilidade -->
    <button
      id="btnAcessibilidade"
      class="btn-acessibilidade"
      aria-label="Abrir menu de acessibilidade"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="16"
        height="16"
        fill="currentColor"
        class="bi bi-universal-access-circle"
        viewBox="0 0 16 16"
      >
        <path
          d="M8 4.143A1.071 1.071 0 1 0 8 2a1.071 1.071 0 0 0 0 2.143m-4.668 1.47 3.24.316v2.5l-.323 4.585A.383.383 0 0 0 7 13.14l.826-4.017c.045-.18.301-.18.346 0L9 13.139a.383.383 0 0 0 .752-.125L9.43 8.43v-2.5l3.239-.316a.38.38 0 0 0-.047-.756H3.379a.38.38 0 0 0-.047.756Z"
        />
        <path
          d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0M1 8a7 7 0 1 1 14 0A7 7 0 0 1 1 8"
        />
      </svg>
    </button>

    <div id="menuAcessibilidade" class="menu-acessibilidade hidden">
      <h3>Acessibilidade</h3>
      <button id="aumentarFonte">Aumentar Fonte</button>
      <button id="diminuirFonte">Diminuir Fonte</button>
      <button id="altoContraste">Alto Contraste</button>
      <button id="resetarAcessibilidade">Resetar</button>
    </div>

    <!-- Content -->
    <div class="content">
      <!-- Home Page -->
      <div id="page-home" class="page">
        <div class="welcome">
          <div class="welcome-icon">üêæ</div>
          <h1>Bem-vindo ao Unipet!</h1>
          <p>
            A <strong>Unipet</strong> conecta animais que precisam de um lar a
            pessoas interessadas em adotar, tornando o processo mais √°gil e
            transparente.
          </p>
        </div>
      </div>

      <!-- Pets Page -->
      <div id="page-pets" class="page hidden"></div>

      <!-- Donations Page -->
      <div id="page-donations" class="page hidden">
        <h2 class="section-title">
          <i class="fa-solid fa-hand-holding-heart"></i> Doa√ß√µes para Pets
        </h2>
        <p class="donations-description">
          Ajude os pets com doa√ß√µes de ra√ß√£o, rem√©dios e outros itens essenciais!
        </p>

        <div class="donation-categories">
          <div class="donation-card" data-type="racao">
            <div class="donation-icon">
              <i class="fa-solid fa-bowl-food"></i>
            </div>
            <h3>Ra√ß√£o</h3>
            <p>Alimentos para c√£es e gatos</p>
            <button class="btn-donate">Doar Agora</button>
          </div>

          <div class="donation-card" data-type="remedio">
            <div class="donation-icon">
              <i class="fa-solid fa-pills"></i>
            </div>
            <h3>Rem√©dios</h3>
            <p>Medicamentos veterin√°rios</p>
            <button class="btn-donate">Doar Agora</button>
          </div>

          <div class="donation-card" data-type="acessorios">
            <div class="donation-icon">
              <i class="fa-solid fa-paw"></i>
            </div>
            <h3>Acess√≥rios</h3>
            <p>Coleiras, camas, brinquedos</p>
            <button class="btn-donate">Doar Agora</button>
          </div>

          <div class="donation-card" data-type="dinheiro">
            <div class="donation-icon">
              <i class="fa-solid fa-dollar-sign"></i>
            </div>
            <h3>Doa√ß√£o Financeira</h3>
            <p>Contribua financeiramente</p>
            <button class="btn-donate">Doar Agora</button>
          </div>
        </div>

        <!-- Modal de Doa√ß√£o -->
        <div id="modalDonation" class="modal hidden">
          <div class="modal-content">
            <button class="modal-close" id="closeDonationModal">
              <i class="fa-solid fa-xmark"></i>
            </button>
            <h3><i class="fa-solid fa-heart"></i> Fazer Doa√ß√£o</h3>
            <form id="formDonation">
              <div class="form-group">
                <label for="donationType">
                  <i class="fa-solid fa-gift"></i> Tipo de Doa√ß√£o
                </label>
                <input type="text" id="donationType" readonly />
              </div>

              <!-- Campos espec√≠ficos para Ra√ß√£o -->
              <div id="camposRacao" class="campos-especificos hidden">
                <div class="form-group">
                  <label for="racaoNome">
                    <i class="fa-solid fa-tag"></i> Nome/Marca da Ra√ß√£o
                  </label>
                  <input type="text" id="racaoNome" placeholder="Ex: Golden, Pedigree, Royal Canin" />
                </div>
                <div class="form-group">
                  <label for="racaoTipo">
                    <i class="fa-solid fa-paw"></i> Para qual animal?
                  </label>
                  <select id="racaoTipo">
                    <option value="">Selecione...</option>
                    <option value="cachorro">Cachorro</option>
                    <option value="gato">Gato</option>
                    <option value="ambos">Ambos</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="racaoQuantidade">
                    <i class="fa-solid fa-weight-scale"></i> Quantidade
                  </label>
                  <input type="text" id="racaoQuantidade" placeholder="Ex: 15kg, 3 pacotes de 5kg" />
                </div>
                <div class="form-group">
                  <label for="racaoValidade">
                    <i class="fa-solid fa-calendar"></i> Validade
                  </label>
                  <input type="date" id="racaoValidade" />
                </div>
              </div>

              <!-- Campos espec√≠ficos para Rem√©dios -->
              <div id="camposRemedio" class="campos-especificos hidden">
                <div class="form-group">
                  <label for="remedioNome">
                    <i class="fa-solid fa-pills"></i> Nome do Rem√©dio
                  </label>
                  <input type="text" id="remedioNome" placeholder="Ex: Antibi√≥tico, Verm√≠fugo" />
                </div>
                <div class="form-group">
                  <label for="remedioTipo">
                    <i class="fa-solid fa-capsules"></i> Tipo
                  </label>
                  <input type="text" id="remedioTipo" placeholder="Ex: Comprimido, L√≠quido, Pomada" />
                </div>
                <div class="form-group">
                  <label for="remedioQuantidade">
                    <i class="fa-solid fa-hashtag"></i> Quantidade
                  </label>
                  <input type="text" id="remedioQuantidade" placeholder="Ex: 2 caixas, 1 frasco" />
                </div>
                <div class="form-group">
                  <label for="remedioValidade">
                    <i class="fa-solid fa-calendar"></i> Validade
                  </label>
                  <input type="date" id="remedioValidade" />
                </div>
              </div>

              <!-- Campos espec√≠ficos para Acess√≥rios -->
              <div id="camposAcessorios" class="campos-especificos hidden">
                <div class="form-group">
                  <label for="acessorioTipo">
                    <i class="fa-solid fa-list"></i> Tipo de Acess√≥rio
                  </label>
                  <select id="acessorioTipo">
                    <option value="">Selecione...</option>
                    <option value="coleira">Coleira</option>
                    <option value="guia">Guia</option>
                    <option value="cama">Cama/Almofada</option>
                    <option value="brinquedo">Brinquedo</option>
                    <option value="comedouro">Comedouro/Bebedouro</option>
                    <option value="casinha">Casinha</option>
                    <option value="outro">Outro</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="acessorioDescricao">
                    <i class="fa-solid fa-align-left"></i> Descri√ß√£o
                  </label>
                  <input type="text" id="acessorioDescricao" placeholder="Ex: Coleira azul tamanho M, Cama grande" />
                </div>
                <div class="form-group">
                  <label for="acessorioEstado">
                    <i class="fa-solid fa-star"></i> Estado
                  </label>
                  <select id="acessorioEstado">
                    <option value="">Selecione...</option>
                    <option value="novo">Novo</option>
                    <option value="seminovo">Semi-novo</option>
                    <option value="usado">Usado (bom estado)</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="acessorioQuantidade">
                    <i class="fa-solid fa-hashtag"></i> Quantidade
                  </label>
                  <input type="number" id="acessorioQuantidade" placeholder="Ex: 1, 2, 3" min="1" />
                </div>
              </div>

              <!-- Campos espec√≠ficos para Doa√ß√£o Financeira -->
              <div id="camposDinheiro" class="campos-especificos hidden">
                <div class="form-group">
                  <label for="dinheiroValor">
                    <i class="fa-solid fa-dollar-sign"></i> Valor da Doa√ß√£o
                  </label>
                  <input type="number" id="dinheiroValor" placeholder="R$ 0,00" min="1" step="0.01" />
                </div>
                <div class="form-group">
                  <label for="dinheiroFrequencia">
                    <i class="fa-solid fa-clock"></i> Frequ√™ncia
                  </label>
                  <select id="dinheiroFrequencia">
                    <option value="unica">Doa√ß√£o √∫nica</option>
                    <option value="mensal">Mensal</option>
                    <option value="trimestral">Trimestral</option>
                    <option value="anual">Anual</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="dinheiroPagamento">
                    <i class="fa-solid fa-credit-card"></i> Forma de Pagamento
                  </label>
                  <select id="dinheiroPagamento">
                    <option value="">Selecione...</option>
                    <option value="pix">PIX</option>
                    <option value="cartao">Cart√£o de Cr√©dito</option>
                    <option value="boleto">Boleto</option>
                    <option value="transferencia">Transfer√™ncia Banc√°ria</option>
                  </select>
                </div>
              </div>

              <div class="form-group">
                <label for="donorName">
                  <i class="fa-solid fa-user"></i> Seu Nome
                </label>
                <input type="text" id="donorName" placeholder="Nome completo" required />
              </div>

              <div class="form-group">
                <label for="donorEmail">
                  <i class="fa-solid fa-envelope"></i> E-mail
                </label>
                <input type="email" id="donorEmail" placeholder="seu@email.com" required />
              </div>

              <div class="form-group">
                <label for="donorPhone">
                  <i class="fa-solid fa-phone"></i> Telefone
                </label>
                <input type="tel" id="donorPhone" placeholder="(00) 00000-0000" required />
              </div>

              <div class="form-group">
                <label for="donationObservacoes">
                  <i class="fa-solid fa-comment"></i> Observa√ß√µes Adicionais
                </label>
                <textarea id="donationObservacoes" placeholder="Informa√ß√µes complementares (opcional)"></textarea>
              </div>

              <div class="modal-buttons">
                <button type="submit">
                  <i class="fa-solid fa-check"></i> Confirmar Doa√ß√£o
                </button>
                <button type="button" id="btnCancelDonation">
                  <i class="fa-solid fa-times"></i> Cancelar
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Profile Page -->
      <div id="page-profile" class="page hidden">
        <div class="profile-header">
          <div class="profile-avatar">
            <i class="fa-solid fa-user"></i>
          </div>
          <div class="profile-name"></div>
          <div class="profile-email"></div>
        </div>

        <div class="profile-menu">
          <div class="menu-item">
            <div class="menu-icon">
              <i class="fa-solid fa-user-pen"></i>
            </div>
            <div class="menu-text">Editar Perfil</div>
            <div class="menu-arrow">
              <i class="fa-solid fa-chevron-right"></i>
            </div>
          </div>

          <div class="menu-item" id="btnPainelAdmin" style="display: none;">
            <div class="menu-icon">
              <i class="fa-solid fa-chart-line"></i>
            </div>
            <div class="menu-text">Painel Administrativo</div>
            <div class="menu-arrow">
              <i class="fa-solid fa-chevron-right"></i>
            </div>
          </div>

          <div class="menu-item" data-action="sair">
            <div class="menu-icon">
              <i class="fa-solid fa-right-from-bracket"></i>
            </div>
            <div class="menu-text">Sair</div>
            <div class="menu-arrow">
              <i class="fa-solid fa-chevron-right"></i>
            </div>
          </div>
        </div>
        <button id="btnAddPetProfile" class="btn-add-pet-profile">
          <i class="fa-solid fa-plus"></i> Adicionar Pet
        </button>
        <!-- Modal para adicionar pet -->
        <div id="modalAddPetProfile" class="modal hidden">
          <div class="modal-content">
            <button class="modal-close" id="closeModalAddPetProfile" aria-label="Fechar modal">
              <i class="fa-solid fa-xmark"></i>
            </button>
            <h3><i class="fa-solid fa-paw"></i> Adicionar Novo Pet</h3>
            <form id="formAddPetProfile">
              <div class="file-input-container">
                <label class="file-input-label" for="petImage">
                  <input type="file" id="petImage" accept="image/*" required />
                  <span>
                    <i class="fa-solid fa-camera"></i>
                    <strong>Adicionar foto do pet</strong>
                    <small>Clique para escolher uma imagem</small>
                  </span>
                </label>
                <div id="imagePreview" class="image-preview"></div>
              </div>

              <div class="form-group">
                <label for="petTag">
                  <i class="fa-solid fa-tag"></i> Nome do Pet
                </label>
                <input
                  type="text"
                  id="petTag"
                  placeholder="Ex: Rex, Mimi, Bolinha"
                  required
                />
              </div>

              <div class="form-group">
                <label for="petTipo">
                  <i class="fa-solid fa-paw"></i> Tipo
                </label>
                <select id="petTipo" required>
                  <option value="">Selecione o tipo...</option>
                  <option value="Cachorro">Cachorro</option>
                  <option value="Gato">Gato</option>
                  <option value="P√°ssaro">P√°ssaro</option>
                  <option value="Coelho">Coelho</option>
                  <option value="Outro">Outro</option>
                </select>
              </div>

              <div class="form-group">
                <label for="petIdade">
                  <i class="fa-solid fa-calendar"></i> Idade (anos)
                </label>
                <input
                  type="number"
                  id="petIdade"
                  placeholder="Ex: 2"
                  min="0"
                  max="30"
                  required
                />
              </div>

              <div class="form-group">
                <label for="petDescricao">
                  <i class="fa-solid fa-align-left"></i> Descri√ß√£o
                </label>
                <textarea
                  id="petDescricao"
                  placeholder="Conte sobre a personalidade e caracter√≠sticas do pet..."
                  required
                ></textarea>
              </div>

              <div class="form-group">
                <label for="petRaca">
                  <i class="fa-solid fa-dog"></i> Ra√ßa
                </label>
                <input
                  type="text"
                  id="petRaca"
                  placeholder="Ex: Vira-lata, Labrador, Persa"
                  required
                />
              </div>

              <div class="form-group">
                <label for="petLocal">
                  <i class="fa-solid fa-location-dot"></i> Local
                </label>
                <input
                  type="text"
                  id="petLocal"
                  placeholder="Ex: S√£o Paulo - SP, Rio de Janeiro - RJ"
                  required
                />
              </div>

              <div class="form-group">
                <label for="petContato">
                  <i class="fa-solid fa-phone"></i> Contato
                </label>
                <input
                  type="tel"
                  id="petContato"
                  placeholder="Ex: (11) 99999-9999"
                  required
                />
              </div>

              <div class="modal-buttons">
                <button type="submit">
                  <i class="fa-solid fa-check"></i> Adicionar
                </button>
                <button type="button" id="btnCancelPetProfile">
                  <i class="fa-solid fa-times"></i> Cancelar
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Modal/Form para adicionar pet -->

      <!-- Modal de Detalhes do Pet -->
      <div id="modalPetDetails" class="modal hidden">
        <div class="modal-content modal-pet-details">
          <button class="modal-close" id="closePetDetailsModal">
            <i class="fa-solid fa-xmark"></i>
          </button>
          <div id="petDetailsContent">
            <!-- Conte√∫do ser√° preenchido dinamicamente -->
          </div>
        </div>
      </div>

      <!-- Modal de Ado√ß√£o -->
      <div id="modalAdoption" class="modal hidden">
        <div class="modal-content">
          <button class="modal-close" id="closeAdoptionModal">
            <i class="fa-solid fa-xmark"></i>
          </button>
          <h3><i class="fa-solid fa-heart"></i> Formul√°rio de Ado√ß√£o</h3>
          <form id="formAdoption">
            <input type="hidden" id="adoptionPetId" />
            <input type="hidden" id="adoptionPetName" />

            <div class="form-group">
              <label for="adopter-name">
                <i class="fa-solid fa-user"></i> Nome Completo
              </label>
              <input type="text" id="adopter-name" placeholder="Seu nome completo" required />
            </div>

            <div class="form-group">
              <label for="adopter-email">
                <i class="fa-solid fa-envelope"></i> E-mail
              </label>
              <input type="email" id="adopter-email" placeholder="seu@email.com" required />
            </div>

            <div class="form-group">
              <label for="adopter-phone">
                <i class="fa-solid fa-phone"></i> Telefone
              </label>
              <input type="tel" id="adopter-phone" placeholder="(00) 00000-0000" required />
            </div>

            <div class="form-group">
              <label for="adopter-cpf">
                <i class="fa-solid fa-id-card"></i> CPF
              </label>
              <input type="text" id="adopter-cpf" placeholder="000.000.000-00" required />
            </div>

            <div class="form-group">
              <label for="adopter-address">
                <i class="fa-solid fa-location-dot"></i> Endere√ßo Completo
              </label>
              <textarea id="adopter-address" placeholder="Rua, n√∫mero, bairro, cidade, estado" required></textarea>
            </div>

            <div class="form-group">
              <label for="adopter-experience">
                <i class="fa-solid fa-paw"></i> Experi√™ncia com Pets
              </label>
              <select id="adopter-experience" required>
                <option value="">Selecione...</option>
                <option value="primeira-vez">Primeira vez com pet</option>
                <option value="ja-teve">J√° tive pets antes</option>
                <option value="tenho-atualmente">Tenho pets atualmente</option>
              </select>
            </div>

            <div class="form-group">
              <label for="adopter-motivation">
                <i class="fa-solid fa-message"></i> Por que deseja adotar?
              </label>
              <textarea id="adopter-motivation" placeholder="Conte-nos sobre sua motiva√ß√£o..." required></textarea>
            </div>

            <div class="form-group checkbox-group">
              <label>
                <input type="checkbox" id="adopter-terms" required />
                <span>Concordo com os termos de ado√ß√£o respons√°vel e me comprometo a cuidar do animal</span>
              </label>
            </div>

            <div class="modal-buttons">
              <button type="submit">
                <i class="fa-solid fa-check"></i> Enviar Solicita√ß√£o
              </button>
              <button type="button" id="btnCancelAdoption">
                <i class="fa-solid fa-times"></i> Cancelar
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Footer Navigation -->
    <nav class="footer-nav">
      <a class="nav-item active" data-page="home">
        <i class="fa-solid fa-house nav-icon"></i>
        <span class="nav-label">In√≠cio</span>
      </a>
      <a class="nav-item" data-page="pets">
        <i class="fa-solid fa-paw nav-icon"></i>
        <span class="nav-label">Pets</span>
      </a>
      <a class="nav-item" data-page="donations">
        <i class="fa-solid fa-hand-holding-heart nav-icon"></i>
        <span class="nav-label">Doa√ß√µes</span>
      </a>
      <a class="nav-item" data-page="profile">
        <i class="fa-solid fa-user nav-icon"></i>
        <span class="nav-label">Perfil</span>
      </a>
    </nav>

    <script src="../../public/script.js"></script>
    <script src="../api.js"></script>
    <script>
      // ============================================
      // üîê VERIFICA√á√ÉO DE AUTENTICA√á√ÉO
      // ============================================
      const usuario = obterUsuarioLogado();

      if (!usuario) {
        window.location.href = "loguin.html";
      } else {
        document.querySelector(".profile-name").textContent = usuario.nome;
        document.querySelector(".profile-email").textContent = usuario.email;
        
        // Mostrar painel admin para administradores
        if (eAdmin()) {
          document.getElementById('btnPainelAdmin').style.display = 'flex';
        }
      }

      // ============================================
      // üì± NAVEGA√á√ÉO DO MENU INFERIOR
      // ============================================
      const navItems = document.querySelectorAll(".nav-item");
      const pages = document.querySelectorAll(".page");
      navItems.forEach((item) => {
        item.addEventListener("click", function (e) {
          e.preventDefault();
          navItems.forEach((nav) => nav.classList.remove("active"));
          this.classList.add("active");
          pages.forEach((p) => p.classList.add("hidden"));
          const pageName = this.getAttribute("data-page");
          document
            .getElementById(`page-${pageName}`)
            .classList.remove("hidden");
        });
      });

      // ============================================
      // üë§ PERFIL - EDITAR E SAIR
      // ============================================
      const menuItems = document.querySelectorAll(".profile-menu .menu-item");
      const editarPerfilBtn = menuItems[0];
      const painelAdminBtn = document.getElementById('btnPainelAdmin');
      const sairBtn = menuItems[menuItems.length - 1];

      editarPerfilBtn.addEventListener("click", async () => {
        const novoNome = prompt("Digite seu novo nome:", usuario.nome);
        const novoEmail = prompt("Digite seu novo email:", usuario.email);
        if (!novoNome || !novoEmail) return alert("Nome e email obrigat√≥rios!");
        
        try {
          // Usar fun√ß√£o da API
          const usuarioAtualizado = await atualizarUsuario(usuario.id, {
            nome: novoNome,
            email: novoEmail
          });
          
          // Atualizar localStorage e interface
          usuario.nome = novoNome;
          usuario.email = novoEmail;
          salvarUsuarioLogado(usuario);
          document.querySelector(".profile-name").textContent = novoNome;
          document.querySelector(".profile-email").textContent = novoEmail;
          
          alert("‚úÖ Perfil atualizado com sucesso!");
        } catch (error) {
          alert("‚ùå Erro ao atualizar perfil: " + error.message);
        }
      });

      sairBtn.addEventListener("click", () => {
        removerUsuarioLogado();
        window.location.href = "loguin.html";
      });

      painelAdminBtn?.addEventListener("click", () => {
        window.location.href = "admin.html";
      });

      // ============================================
      // üêæ CARREGAR PETS (USA API)
      // ============================================
      async function carregarPets() {
        try {
          console.log('üîÑ Carregando pets via API...');
          
          // Usar fun√ß√£o da API
          const pets = await listarPets({ disponivel: true });
          console.log('‚úÖ Pets carregados:', pets.length);
          
          const container = document.getElementById("page-pets");
          container.innerHTML = `<h2 class="section-title"><i class="fa-solid fa-dog"></i> Pets para Ado√ß√£o</h2>`;
          
          pets.forEach((p) => {
            const card = document.createElement("div");
            card.className = "pet-card clickable";
            card.setAttribute('data-pet-id', p.id);
            card.innerHTML = `
              <div class="pet-avatar"><img src="${p.imagem}" alt="${p.nome}" /></div>
              <div class="pet-info">
                <div class="pet-name">${p.nome}</div>
                <div class="pet-details"><span>${p.tipo}</span> ‚Ä¢ <span>${p.idade || "?"} anos</span></div>
                <div class="pet-badge">Dispon√≠vel</div>
              </div>
              <div class="pet-arrow">
                <i class="fa-solid fa-chevron-right"></i>
              </div>`;
            
            card.addEventListener('click', (e) => {
              console.log('Card clicado:', p.nome);
              mostrarDetalhesPet(p);
            });
            container.appendChild(card);
          });
          
          console.log('Cards de pets criados:', pets.length);
        } catch (error) {
          console.error('Erro ao carregar pets:', error);
          const container = document.getElementById("page-pets");
          container.innerHTML = `
            <h2 class="section-title"><i class="fa-solid fa-dog"></i> Pets para Ado√ß√£o</h2>
            <p style="text-align: center; color: #ef4444; padding: 20px;">
              Erro ao carregar pets. Verifique se o servidor est√° rodando.
            </p>
          `;
        }
      }

      // Mostrar detalhes do pet (fun√ß√£o global)
      window.mostrarDetalhesPet = function(pet) {
        console.log('Mostrando detalhes do pet:', pet);
        
        const modal = document.getElementById('modalPetDetails');
        const content = document.getElementById('petDetailsContent');
        
        if (!modal || !content) {
          console.error('Modal ou conte√∫do n√£o encontrado!');
          return;
        }
        
        content.innerHTML = `
          <div class="pet-details-header">
            <img src="${pet.imagem}" alt="${pet.nome}" class="pet-details-image" />
            <h2>${pet.nome}</h2>
            <div class="pet-details-badge">Dispon√≠vel para Ado√ß√£o</div>
          </div>
          
          <div class="pet-details-info">
            <div class="info-item">
              <i class="fa-solid fa-paw"></i>
              <div>
                <strong>Tipo:</strong>
                <span>${pet.tipo}</span>
              </div>
            </div>
            
            <div class="info-item">
              <i class="fa-solid fa-calendar"></i>
              <div>
                <strong>Idade:</strong>
                <span>${pet.idade || 'N√£o informada'} anos</span>
              </div>
            </div>
            
            <div class="info-item">
              <i class="fa-solid fa-tag"></i>
              <div>
                <strong>Ra√ßa:</strong>
                <span>${pet.raca || 'N√£o informada'}</span>
              </div>
            </div>
            
            <div class="info-item">
              <i class="fa-solid fa-location-dot"></i>
              <div>
                <strong>Localiza√ß√£o:</strong>
                <span>${pet.local || 'N√£o informada'}</span>
              </div>
            </div>
            
            <div class="info-item">
              <i class="fa-solid fa-phone"></i>
              <div>
                <strong>Contato:</strong>
                <span>${pet.contato || 'N√£o informado'}</span>
              </div>
            </div>
          </div>
          
          ${pet.descricao ? `
          <div class="pet-details-description">
            <h4><i class="fa-solid fa-align-left"></i> Descri√ß√£o</h4>
            <p>${pet.descricao}</p>
          </div>` : ''}
          
          <div class="pet-details-actions">
            <button class="btn-adopt" onclick="abrirFormularioAdocao(${pet.id}, '${pet.nome}')">
              <i class="fa-solid fa-heart"></i> Quero Adotar
            </button>
            <button class="btn-share">
              <i class="fa-solid fa-share-nodes"></i> Compartilhar
            </button>
          </div>
        `;
        
        modal.classList.remove('hidden');
      }

      // Abrir formul√°rio de ado√ß√£o (fun√ß√£o global)
      window.abrirFormularioAdocao = function(petId, petName) {
        document.getElementById('modalPetDetails').classList.add('hidden');
        document.getElementById('adoptionPetId').value = petId;
        document.getElementById('adoptionPetName').value = petName;
        document.getElementById('modalAdoption').classList.remove('hidden');
      }

      // Fechar modais ao clicar no X
      document.getElementById('closePetDetailsModal')?.addEventListener('click', () => {
        document.getElementById('modalPetDetails').classList.add('hidden');
      });

      // Fechar modal ao clicar fora
      document.getElementById('modalPetDetails')?.addEventListener('click', (e) => {
        if (e.target.id === 'modalPetDetails') {
          document.getElementById('modalPetDetails').classList.add('hidden');
        }
      });

      // ============================================
      // üíö FORMUL√ÅRIO DE ADO√á√ÉO (USA API)
      // ============================================
      document.getElementById('formAdoption')?.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        // Validar checkbox de termos
        if (!document.getElementById('adopter-terms').checked) {
          alert('‚ö†Ô∏è Voc√™ precisa concordar com os termos de ado√ß√£o respons√°vel.');
          return;
        }
        
        const petId = parseInt(document.getElementById('adoptionPetId').value);
        const petName = document.getElementById('adoptionPetName').value;
        
        const adocaoData = {
          petId: petId,
          petNome: petName,
          adotante: {
            nome: document.getElementById('adopter-name').value,
            email: document.getElementById('adopter-email').value,
            telefone: document.getElementById('adopter-phone').value,
            cpf: document.getElementById('adopter-cpf').value,
            endereco: document.getElementById('adopter-address').value,
            experiencia: document.getElementById('adopter-experience').value,
            motivacao: document.getElementById('adopter-motivation').value
          },
          usuarioLogado: {
            id: usuario.id,
            nome: usuario.nome,
            email: usuario.email
          }
        };
        
        try {
          console.log('üì§ Enviando solicita√ß√£o de ado√ß√£o...');
          
          // Usar fun√ß√£o da API
          const adocao = await criarAdocao(adocaoData);
          
          console.log('‚úÖ Ado√ß√£o registrada:', adocao);
          
          alert(`‚úÖ Solicita√ß√£o de ado√ß√£o enviada com sucesso!\n\nüêæ Pet: ${petName}\nüìÖ Data: ${formatarData(adocao.datasolicitacao)}\n\nüìß Voc√™ receber√° um e-mail em breve com os pr√≥ximos passos para adotar ${petName}.\n\nObrigado por escolher a ado√ß√£o respons√°vel! ‚ù§Ô∏è`);
          
          // Fechar modal e limpar formul√°rio
          document.getElementById('modalAdoption').classList.add('hidden');
          document.getElementById('formAdoption').reset();
        } catch (error) {
          console.error('‚ùå Erro ao enviar ado√ß√£o:', error);
          alert('‚ùå Erro ao enviar solicita√ß√£o: ' + error.message);
        }
      });

      document.getElementById('closeAdoptionModal')?.addEventListener('click', () => {
        document.getElementById('modalAdoption').classList.add('hidden');
      });

      document.getElementById('btnCancelAdoption')?.addEventListener('click', () => {
        document.getElementById('modalAdoption').classList.add('hidden');
      });

      // Inicializar doa√ß√µes ap√≥s o DOM carregar completamente
      function inicializarDoacoes() {
        const donationCards = document.querySelectorAll('.donation-card .btn-donate');
        console.log('Bot√µes de doa√ß√£o encontrados:', donationCards.length);
        
        donationCards.forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            
            const card = e.target.closest('.donation-card');
            const type = card.getAttribute('data-type');
            const typeNames = {
              'racao': 'Ra√ß√£o',
              'remedio': 'Rem√©dios',
              'acessorios': 'Acess√≥rios',
              'dinheiro': 'Doa√ß√£o Financeira'
            };
            
            document.getElementById('donationType').value = typeNames[type];
            
            // Esconder todos os campos espec√≠ficos
            document.querySelectorAll('.campos-especificos').forEach(campo => {
              campo.classList.add('hidden');
            });
            
            // Mostrar campos espec√≠ficos baseado no tipo
            if (type === 'racao') {
              document.getElementById('camposRacao').classList.remove('hidden');
            } else if (type === 'remedio') {
              document.getElementById('camposRemedio').classList.remove('hidden');
            } else if (type === 'acessorios') {
              document.getElementById('camposAcessorios').classList.remove('hidden');
            } else if (type === 'dinheiro') {
              document.getElementById('camposDinheiro').classList.remove('hidden');
            }
            
            document.getElementById('modalDonation').classList.remove('hidden');
          });
        });
      }

      document.getElementById('closeDonationModal')?.addEventListener('click', () => {
        document.getElementById('modalDonation').classList.add('hidden');
      });

      document.getElementById('btnCancelDonation')?.addEventListener('click', () => {
        document.getElementById('modalDonation').classList.add('hidden');
      });

      // Fechar modal de doa√ß√£o ao clicar fora
      document.getElementById('modalDonation')?.addEventListener('click', (e) => {
        if (e.target.id === 'modalDonation') {
          document.getElementById('modalDonation').classList.add('hidden');
        }
      });

      // Fechar modal de ado√ß√£o ao clicar fora
      document.getElementById('modalAdoption')?.addEventListener('click', (e) => {
        if (e.target.id === 'modalAdoption') {
          document.getElementById('modalAdoption').classList.add('hidden');
        }
      });

      // ============================================
      // ‚ù§Ô∏è FORMUL√ÅRIO DE DOA√á√ÉO (USA API)
      // ============================================
      document.getElementById('formDonation')?.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const tipo = document.getElementById('donationType').value;
        const doacaoData = {
          tipo: tipo,
          doador: {
            nome: document.getElementById('donorName').value,
            email: document.getElementById('donorEmail').value,
            telefone: document.getElementById('donorPhone').value
          },
          observacoes: document.getElementById('donationObservacoes').value,
          detalhes: {}
        };
        
        // Adicionar dados espec√≠ficos baseado no tipo
        if (tipo === 'Ra√ß√£o') {
          doacaoData.detalhes = {
            nomeMarca: document.getElementById('racaoNome').value,
            tipoAnimal: document.getElementById('racaoTipo').value,
            quantidade: document.getElementById('racaoQuantidade').value,
            validade: document.getElementById('racaoValidade').value
          };
        } else if (tipo === 'Rem√©dios') {
          doacaoData.detalhes = {
            nome: document.getElementById('remedioNome').value,
            tipo: document.getElementById('remedioTipo').value,
            quantidade: document.getElementById('remedioQuantidade').value,
            validade: document.getElementById('remedioValidade').value
          };
        } else if (tipo === 'Acess√≥rios') {
          doacaoData.detalhes = {
            tipo: document.getElementById('acessorioTipo').value,
            descricao: document.getElementById('acessorioDescricao').value,
            estado: document.getElementById('acessorioEstado').value,
            quantidade: document.getElementById('acessorioQuantidade').value
          };
        } else if (tipo === 'Doa√ß√£o Financeira') {
          doacaoData.detalhes = {
            valor: document.getElementById('dinheiroValor').value,
            frequencia: document.getElementById('dinheiroFrequencia').value,
            formaPagamento: document.getElementById('dinheiroPagamento').value
          };
        }
        
        try {
          console.log('üì§ Enviando doa√ß√£o...');
          
          // Usar fun√ß√£o da API
          const doacao = await criarDoacao(doacaoData);
          
          console.log('‚úÖ Doa√ß√£o registrada:', doacao);
          
          alert(`‚úÖ Obrigado pela sua doa√ß√£o de ${tipo}!\n\nüìÖ Data: ${formatarData(doacao.data)}\n\nüìß Entraremos em contato em breve para combinar os detalhes.\n\nSua generosidade faz a diferen√ßa! ‚ù§Ô∏è`);
          
          document.getElementById('modalDonation').classList.add('hidden');
          document.getElementById('formDonation').reset();
          
          // Esconder todos os campos espec√≠ficos ap√≥s reset
          document.querySelectorAll('.campos-especificos').forEach(campo => {
            campo.classList.add('hidden');
          });
        } catch (error) {
          console.error('‚ùå Erro ao enviar doa√ß√£o:', error);
          alert('‚ùå Erro ao registrar doa√ß√£o: ' + error.message);
        }
      });

      // Carregar pets e inicializar doa√ß√µes
      carregarPets();
      
      // Esperar um pouco para garantir que os elementos estejam renderizados
      setTimeout(() => {
        inicializarDoacoes();
      }, 100);
    </script>
    <script src="../../server/pet.js"></script>
  </body>
</html>
