<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Unipet - Painel Administrativo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="../../public/style.css" />
    <link rel="stylesheet" href="../../public/admin.css" />
  </head>
  <body>
    <!-- Menu de Acessibilidade -->
    <div class="accessibility-menu">
      <button id="btnAcessibilidade" class="btn-accessibility" aria-label="Abre menu de acessibilidade">
        <i class="fa-solid fa-universal-access"></i>
      </button>
      <div id="panelAcessibilidade" class="accessibility-panel" hidden>
        <div class="accessibility-header">
          <h3>Acessibilidade</h3>
          <button id="fecharAcess" class="btn-close" aria-label="Fecha menu de acessibilidade">
            <i class="fa-solid fa-times"></i>
          </button>
        </div>
        <div class="accessibility-content">
          <div class="accessibility-group">
            <label for="fontSizeSlider">Tamanho da Fonte</label>
            <div class="slider-container">
              <button id="btnFonteMenuor" class="btn-font-control" aria-label="Diminui tamanho da fonte">
                <i class="fa-solid fa-minus"></i>
              </button>
              <input type="range" id="fontSizeSlider" min="0.8" max="1.4" step="0.1" value="1" aria-label="Controle de tamanho da fonte">
              <button id="btnFonteMaior" class="btn-font-control" aria-label="Aumenta tamanho da fonte">
                <i class="fa-solid fa-plus"></i>
              </button>
              <span id="fontSizeValue" class="font-size-value">100%</span>
            </div>
          </div>

          <div class="accessibility-group">
            <button id="btnHighContrast" class="btn-accessibility-option" aria-label="Ativa modo de alto contraste">
              <i class="fa-solid fa-adjust"></i>
              <span>Alto Contraste</span>
            </button>
          </div>

          <div class="accessibility-group">
            <button id="btnTextSpacing" class="btn-accessibility-option" aria-label="Aumenta espa√ßamento de texto">
              <i class="fa-solid fa-arrow-down-z-a"></i>
              <span>Espa√ßamento</span>
            </button>
          </div>

          <div class="accessibility-group">
            <button id="btnResetAcess" class="btn-accessibility-option btn-reset" aria-label="Reseta todas as op√ß√µes de acessibilidade">
              <i class="fa-solid fa-redo"></i>
              <span>Resetar</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="admin-container">
      <!-- Bot√£o Voltar -->
      <a href="index.html" class="back-btn" aria-label="Volta para p√°gina principal">
        <i class="fa-solid fa-arrow-left"></i>
        Voltar ao Sistema
      </a>

      <!-- Header do Admin -->
      <div class="admin-header">
        <div>
          <h1><i class="fa-solid fa-chart-line"></i> Painel Administrativo</h1>
          <p>Gerencie usu√°rios, pets, ado√ß√µes e doa√ß√µes do Unipet</p>
        </div>
        <button class="btn-logout" onclick="fazerLogout()" aria-label="Fazer logout">
          <i class="fa-solid fa-sign-out-alt"></i> Sair
        </button>
      </div>

      <!-- Cards de Estat√≠sticas -->
      <div class="stats-grid" role="region" aria-label="Estat√≠sticas gerais do sistema">
        <div class="stat-card">
          <div class="icon">üë•</div>
          <div class="number" id="totalUsuarios">0</div>
          <div class="label">Usu√°rios</div>
        </div>
        <div class="stat-card">
          <div class="icon">üêæ</div>
          <div class="number" id="totalPets">0</div>
          <div class="label">Pets para Ado√ß√£o</div>
        </div>
        <div class="stat-card">
          <div class="icon">üíö</div>
          <div class="number" id="totalAdocoes">0</div>
          <div class="label">Solicita√ß√µes de Ado√ß√£o</div>
        </div>
        <div class="stat-card">
          <div class="icon">‚ù§Ô∏è</div>
          <div class="number" id="totalDoacoes">0</div>
          <div class="label">Doa√ß√µes Recebidas</div>
        </div>
      </div>

      <!-- Abas de Navega√ß√£o -->
      <div class="section-tabs" role="tablist" aria-label="Se√ß√µes do painel administrativo">
        <button class="tab-btn active" onclick="mostrarAba('usuariosContent')" role="tab" aria-selected="true" aria-label="Se√ß√£o de usu√°rios">
          <i class="fa-solid fa-users"></i> Usu√°rios
        </button>
        <button class="tab-btn" onclick="mostrarAba('petsContent')" role="tab" aria-selected="false" aria-label="Se√ß√£o de pets">
          <i class="fa-solid fa-paw"></i> Pets
        </button>
        <button class="tab-btn" onclick="mostrarAba('adocoesContent')" role="tab" aria-selected="false" aria-label="Se√ß√£o de ado√ß√µes">
          <i class="fa-solid fa-heart"></i> Ado√ß√µes
        </button>
        <button class="tab-btn" onclick="mostrarAba('doacoesContent')" role="tab" aria-selected="false" aria-label="Se√ß√£o de doa√ß√µes">
          <i class="fa-solid fa-hand-holding-heart"></i> Doa√ß√µes
        </button>
      </div>

      <!-- Conte√∫do das Abas -->

      <!-- Aba Usu√°rios -->
      <div id="usuariosContent" class="tab-content active" role="tabpanel" aria-label="Se√ß√£o de usu√°rios do sistema">
        <div class="content-header">
          <h2>Gerenciar Usu√°rios</h2>
          <button class="btn-primary" onclick="abrirFormularioUsuario()" aria-label="Adicionar novo usu√°rio">
            <i class="fa-solid fa-plus"></i> Novo Usu√°rio
          </button>
        </div>
        <div id="usuariosGrid" class="info-grid"></div>
      </div>

      <!-- Aba Pets -->
      <div id="petsContent" class="tab-content" role="tabpanel" aria-label="Se√ß√£o de pets para ado√ß√£o">
        <div class="content-header">
          <h2>Gerenciar Pets</h2>
          <button class="btn-primary" onclick="abrirFormularioPet()" aria-label="Adicionar novo pet">
            <i class="fa-solid fa-plus"></i> Novo Pet
          </button>
        </div>
        <div id="petsGrid" class="info-grid"></div>
      </div>

      <!-- Aba Ado√ß√µes -->
      <div id="adocoesContent" class="tab-content" role="tabpanel" aria-label="Se√ß√£o de ado√ß√µes">
        <div class="content-header">
          <h2>Gerenciar Ado√ß√µes</h2>
        </div>
        <div id="adocoesGrid" class="info-grid"></div>
      </div>

      <!-- Aba Doa√ß√µes -->
      <div id="doacoesContent" class="tab-content" role="tabpanel" aria-label="Se√ß√£o de doa√ß√µes">
        <div class="content-header">
          <h2>Gerenciar Doa√ß√µes</h2>
        </div>
        <div id="doacoesGrid" class="info-grid"></div>
      </div>
    </div>

    <!-- Modal para Formul√°rio de Usu√°rio -->
    <div id="modalUsuario" class="modal" hidden>
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="tituloModalUsuario">Novo Usu√°rio</h2>
          <button class="btn-close" onclick="fecharModalUsuario()" aria-label="Fecha modal de usu√°rio">
            <i class="fa-solid fa-times"></i>
          </button>
        </div>
        <form id="formUsuario" onsubmit="salvarUsuario(event)">
          <div class="form-group">
            <label for="inputNomeUsuario">Nome *</label>
            <input type="text" id="inputNomeUsuario" required placeholder="Nome do usu√°rio">
          </div>
          <div class="form-group">
            <label for="inputEmailUsuario">Email *</label>
            <input type="email" id="inputEmailUsuario" required placeholder="email@exemplo.com">
          </div>
          <div class="form-group">
            <label for="inputSenhaUsuario">Senha *</label>
            <input type="password" id="inputSenhaUsuario" required placeholder="Digite a senha">
          </div>
          <div class="form-group">
            <label for="inputAdminUsuario">
              <input type="checkbox" id="inputAdminUsuario">
              <span>√â administrador?</span>
            </label>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn-secondary" onclick="fecharModalUsuario()">Cancelar</button>
            <button type="submit" class="btn-primary">Salvar</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal para Formul√°rio de Pet -->
    <div id="modalPet" class="modal" hidden>
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="tituloModalPet">Novo Pet</h2>
          <button class="btn-close" onclick="fecharModalPet()" aria-label="Fecha modal de pet">
            <i class="fa-solid fa-times"></i>
          </button>
        </div>
        <form id="formPet" onsubmit="salvarPet(event)">
          <div class="form-group">
            <label for="inputNomePet">Nome *</label>
            <input type="text" id="inputNomePet" required placeholder="Nome do pet">
          </div>
          <div class="form-group">
            <label for="inputTipoPet">Tipo *</label>
            <select id="inputTipoPet" required>
              <option value="">Selecione o tipo</option>
              <option value="Cachorro">Cachorro</option>
              <option value="Gato">Gato</option>
              <option value="Passaro">P√°ssaro</option>
              <option value="Roedor">Roedor</option>
              <option value="Outro">Outro</option>
            </select>
          </div>
          <div class="form-group">
            <label for="inputRacaPet">Ra√ßa *</label>
            <input type="text" id="inputRacaPet" required placeholder="Ra√ßa do pet">
          </div>
          <div class="form-group">
            <label for="inputIdadePet">Idade (anos) *</label>
            <input type="number" id="inputIdadePet" required min="0" step="0.1" placeholder="Ex: 2.5">
          </div>
          <div class="form-group">
            <label for="inputLocalPet">Local *</label>
            <input type="text" id="inputLocalPet" required placeholder="Localiza√ß√£o do pet">
          </div>
          <div class="form-group">
            <label for="inputContatoPet">Contato *</label>
            <input type="tel" id="inputContatoPet" required placeholder="Telefone ou email">
          </div>
          <div class="form-group">
            <label for="inputDescricaoPet">Descri√ß√£o</label>
            <textarea id="inputDescricaoPet" placeholder="Descreva caracter√≠sticas do pet" rows="3"></textarea>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn-secondary" onclick="fecharModalPet()">Cancelar</button>
            <button type="submit" class="btn-primary">Salvar</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Scripts -->
    <script src="../api.js"></script>
    <script>
      // Configura√ß√µes de Acessibilidade
      const config = {
        fontSize: 1,
        highContrast: false,
        textSpacing: false
      };

      // Inicializa√ß√£o de Acessibilidade
      function initAccessibility() {
        const btnAcess = document.getElementById('btnAcessibilidade');
        const panel = document.getElementById('panelAcessibilidade');
        const fechar = document.getElementById('fecharAcess');
        const fontSlider = document.getElementById('fontSizeSlider');
        const btnFonteMaior = document.getElementById('btnFonteMaior');
        const btnFonteMenuor = document.getElementById('btnFonteMenuor');
        const btnHighContrast = document.getElementById('btnHighContrast');
        const btnTextSpacing = document.getElementById('btnTextSpacing');
        const btnReset = document.getElementById('btnResetAcess');

        btnAcess.addEventListener('click', () => {
          panel.toggleAttribute('hidden');
        });

        fechar.addEventListener('click', () => {
          panel.setAttribute('hidden', '');
        });

        fontSlider.addEventListener('input', (e) => {
          config.fontSize = parseFloat(e.target.value);
          updateFontSize();
        });

        btnFonteMaior.addEventListener('click', () => {
          config.fontSize = Math.min(1.4, config.fontSize + 0.1);
          fontSlider.value = config.fontSize;
          updateFontSize();
        });

        btnFonteMenuor.addEventListener('click', () => {
          config.fontSize = Math.max(0.8, config.fontSize - 0.1);
          fontSlider.value = config.fontSize;
          updateFontSize();
        });

        btnHighContrast.addEventListener('click', () => {
          config.highContrast = !config.highContrast;
          document.body.classList.toggle('high-contrast', config.highContrast);
          btnHighContrast.classList.toggle('active', config.highContrast);
        });

        btnTextSpacing.addEventListener('click', () => {
          config.textSpacing = !config.textSpacing;
          document.body.classList.toggle('text-spacing', config.textSpacing);
          btnTextSpacing.classList.toggle('active', config.textSpacing);
        });

        btnReset.addEventListener('click', () => {
          config.fontSize = 1;
          config.highContrast = false;
          config.textSpacing = false;
          fontSlider.value = 1;
          document.body.style.fontSize = '1rem';
          document.body.classList.remove('high-contrast', 'text-spacing');
          btnHighContrast.classList.remove('active');
          btnTextSpacing.classList.remove('active');
          updateFontSize();
        });
      }

      function updateFontSize() {
        document.body.style.fontSize = (config.fontSize * 16) + 'px';
        const percent = Math.round(config.fontSize * 100);
        document.getElementById('fontSizeValue').textContent = percent + '%';
      }

      // Fun√ß√µes de Verifica√ß√£o e Carregamento
      async function verificarAdmin() {
        console.log('üîê Verificando acesso ao painel admin...');
        
        const usuario = obterUsuarioLogado();
        console.log('üë§ Usu√°rio logado:', usuario);

        if (!usuario || !usuario.admin) {
          console.log('‚ùå Acesso negado - n√£o √© admin');
          alert('‚ùå Acesso negado! Apenas administradores podem acessar.');
          window.location.href = 'index.html';
          return;
        }

        console.log('‚úÖ Acesso permitido ao painel admin');
        initAccessibility();
        await carregarTodosDados();
      }

      async function carregarTodosDados() {
        try {
          console.log('üìä Carregando todos os dados...');

          const [usuarios, pets, adocoes, doacoes] = await Promise.all([
            listarUsuarios(),
            listarPets(),
            listarAdocoes(),
            listarDoacoes()
          ]);

          console.log('‚úÖ Dados carregados:', {
            usuarios: usuarios.length,
            pets: pets.length,
            adocoes: adocoes.length,
            doacoes: doacoes.length
          });

          // Atualizar estat√≠sticas
          document.getElementById('totalUsuarios').textContent = usuarios.length;
          document.getElementById('totalPets').textContent = pets.length;
          document.getElementById('totalAdocoes').textContent = adocoes.length;
          document.getElementById('totalDoacoes').textContent = doacoes.length;

          // Renderizar grades
          renderizarUsuarios(usuarios);
          renderizarPets(pets);
          renderizarAdocoes(adocoes);
          renderizarDoacoes(doacoes);

        } catch (error) {
          console.error('‚ùå Erro ao carregar dados:', error);
          alert('Erro ao carregar dados: ' + error.message);
        }
      }

      // Renderizar Usu√°rios
      function renderizarUsuarios(usuarios) {
        const grid = document.getElementById('usuariosGrid');
        
        if (!usuarios || usuarios.length === 0) {
          grid.innerHTML = '<p class="empty-message">Nenhum usu√°rio encontrado</p>';
          return;
        }

        grid.innerHTML = usuarios.map(user => `
          <div class="info-card">
            <div class="card-header">
              <h3>${user.nome}</h3>
              <span class="badge ${user.admin ? 'badge-admin' : 'badge-user'}">
                ${user.admin ? 'üëë Admin' : 'üë§ Usu√°rio'}
              </span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-id-badge"></i> ID</label>
              <span>${user.id}</span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-envelope"></i> Email</label>
              <span>${user.email}</span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-calendar"></i> Data Cadastro</label>
              <span>${user.dataCadastro ? new Date(user.dataCadastro).toLocaleDateString('pt-BR') : '-'}</span>
            </div>
            <div class="card-actions">
              <button class="btn-action btn-edit" onclick="editarUsuario(${user.id})" aria-label="Editar usu√°rio">
                <i class="fa-solid fa-edit"></i> Editar
              </button>
              <button class="btn-action btn-delete" onclick="deletarUsuario(${user.id})" aria-label="Deletar usu√°rio">
                <i class="fa-solid fa-trash"></i> Deletar
              </button>
            </div>
          </div>
        `).join('');
      }

      // Renderizar Pets
      function renderizarPets(pets) {
        const grid = document.getElementById('petsGrid');
        
        if (!pets || pets.length === 0) {
          grid.innerHTML = '<p class="empty-message">Nenhum pet encontrado</p>';
          return;
        }

        grid.innerHTML = pets.map(pet => `
          <div class="info-card">
            <div class="card-header">
              <h3>üêæ ${pet.nome}</h3>
              <span class="badge badge-pet">${pet.tipo}</span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-id-badge"></i> ID</label>
              <span>${pet.id}</span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-dog"></i> Ra√ßa</label>
              <span>${pet.raca || '-'}</span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-birthday-cake"></i> Idade</label>
              <span>${pet.idade || '-'} anos</span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-location-dot"></i> Local</label>
              <span>${pet.local || '-'}</span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-phone"></i> Contato</label>
              <span>${pet.contato || '-'}</span>
            </div>
            ${pet.descricao ? `
            <div class="detail-field">
              <label><i class="fa-solid fa-align-left"></i> Descri√ß√£o</label>
              <span>${pet.descricao}</span>
            </div>
            ` : ''}
            <div class="card-actions">
              <button class="btn-action btn-edit" onclick="editarPet(${pet.id})" aria-label="Editar pet">
                <i class="fa-solid fa-edit"></i> Editar
              </button>
              <button class="btn-action btn-delete" onclick="deletarPet(${pet.id})" aria-label="Deletar pet">
                <i class="fa-solid fa-trash"></i> Deletar
              </button>
            </div>
          </div>
        `).join('');
      }

      // Renderizar Ado√ß√µes
      function renderizarAdocoes(adocoes) {
        const grid = document.getElementById('adocoesGrid');
        
        if (!adocoes || adocoes.length === 0) {
          grid.innerHTML = '<p class="empty-message">Nenhuma ado√ß√£o registrada</p>';
          return;
        }

        grid.innerHTML = adocoes.map(adocao => `
          <div class="info-card">
            <div class="card-header">
              <h3>üíö ${adocao.petName || 'Pet'}</h3>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-id-badge"></i> ID</label>
              <span>${adocao.id}</span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-user"></i> Adotante</label>
              <span>${adocao.adotante?.nome || '-'}</span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-envelope"></i> Email</label>
              <span>${adocao.adotante?.email || '-'}</span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-phone"></i> Telefone</label>
              <span>${adocao.adotante?.telefone || '-'}</span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-location-dot"></i> Endere√ßo</label>
              <span>${adocao.adotante?.endereco || '-'}</span>
            </div>
            <div class="card-actions">
              <button class="btn-action btn-view" onclick="verDetalhesAdocao(${adocao.id})" aria-label="Ver detalhes da ado√ß√£o">
                <i class="fa-solid fa-eye"></i> Detalhes
              </button>
              <button class="btn-action btn-delete" onclick="deletarAdocao(${adocao.id})" aria-label="Deletar ado√ß√£o">
                <i class="fa-solid fa-trash"></i> Deletar
              </button>
            </div>
          </div>
        `).join('');
      }

      // Renderizar Doa√ß√µes
      function renderizarDoacoes(doacoes) {
        const grid = document.getElementById('doacoesGrid');
        
        if (!doacoes || doacoes.length === 0) {
          grid.innerHTML = '<p class="empty-message">Nenhuma doa√ß√£o registrada</p>';
          return;
        }

        const icones = {
          'ra√ß√£o': 'ü•´',
          'rem√©dio': 'üíä',
          'acess√≥rios': 'üéÅ',
          'dinheiro': 'üí∞'
        };

        grid.innerHTML = doacoes.map(doacao => `
          <div class="info-card">
            <div class="card-header">
              <h3>${icones[doacao.tipo?.toLowerCase()] || '‚ùì'} ${doacao.doador?.nome || 'An√¥nimo'}</h3>
              <span class="badge badge-doacao">${doacao.tipo || 'Doa√ß√£o'}</span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-id-badge"></i> ID</label>
              <span>${doacao.id}</span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-user"></i> Doador</label>
              <span>${doacao.doador?.nome || doacao.nome || 'An√¥nimo'}</span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-envelope"></i> Email</label>
              <span>${doacao.doador?.email || doacao.email || '-'}</span>
            </div>
            <div class="detail-field">
              <label><i class="fa-solid fa-phone"></i> Telefone</label>
              <span>${doacao.doador?.telefone || doacao.telefone || '-'}</span>
            </div>
            ${doacao.quantidade ? `
            <div class="detail-field">
              <label><i class="fa-solid fa-weight-scale"></i> Quantidade</label>
              <span>${doacao.quantidade}</span>
            </div>
            ` : ''}
            ${doacao.valor ? `
            <div class="detail-field">
              <label><i class="fa-solid fa-dollar-sign"></i> Valor</label>
              <span>R$ ${parseFloat(doacao.valor).toFixed(2).replace('.', ',')}</span>
            </div>
            ` : ''}
            <div class="detail-field">
              <label><i class="fa-solid fa-calendar"></i> Data Doa√ß√£o</label>
              <span>${doacao.dataCadastro ? new Date(doacao.dataCadastro).toLocaleDateString('pt-BR') : '-'}</span>
            </div>
            <div class="card-actions">
              <button class="btn-action btn-view" onclick="verDetalhesDoacao(${doacao.id})" aria-label="Ver detalhes da doa√ß√£o">
                <i class="fa-solid fa-eye"></i> Detalhes
              </button>
              <button class="btn-action btn-delete" onclick="deletarDoacao(${doacao.id})" aria-label="Deletar doa√ß√£o">
                <i class="fa-solid fa-trash"></i> Deletar
              </button>
            </div>
          </div>
        `).join('');
      }

      // Abrir/Fechar Modais e Formul√°rios
      function abrirFormularioUsuario() {
        document.getElementById('tituloModalUsuario').textContent = 'Novo Usu√°rio';
        document.getElementById('formUsuario').reset();
        document.getElementById('modalUsuario').removeAttribute('hidden');
      }

      function fecharModalUsuario() {
        document.getElementById('modalUsuario').setAttribute('hidden', '');
      }

      function abrirFormularioPet() {
        document.getElementById('tituloModalPet').textContent = 'Novo Pet';
        document.getElementById('formPet').reset();
        document.getElementById('modalPet').removeAttribute('hidden');
      }

      function fecharModalPet() {
        document.getElementById('modalPet').setAttribute('hidden', '');
      }

      // Salvar Usu√°rio
      async function salvarUsuario(event) {
        event.preventDefault();
        
        const nome = document.getElementById('inputNomeUsuario').value;
        const email = document.getElementById('inputEmailUsuario').value;
        const senha = document.getElementById('inputSenhaUsuario').value;
        const admin = document.getElementById('inputAdminUsuario').checked;

        try {
          const response = await fetch('http://localhost:3000/usuarios', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ nome, email, senha, admin })
          });

          if (response.ok) {
            alert('‚úÖ Usu√°rio criado com sucesso!');
            fecharModalUsuario();
            await carregarTodosDados();
          } else {
            alert('‚ùå Erro ao criar usu√°rio');
          }
        } catch (error) {
          console.error('Erro:', error);
          alert('Erro: ' + error.message);
        }
      }

      // Salvar Pet
      async function salvarPet(event) {
        event.preventDefault();
        
        const nome = document.getElementById('inputNomePet').value;
        const tipo = document.getElementById('inputTipoPet').value;
        const raca = document.getElementById('inputRacaPet').value;
        const idade = parseFloat(document.getElementById('inputIdadePet').value);
        const local = document.getElementById('inputLocalPet').value;
        const contato = document.getElementById('inputContatoPet').value;
        const descricao = document.getElementById('inputDescricaoPet').value;

        try {
          const response = await fetch('http://localhost:3000/pets', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ nome, tipo, raca, idade, local, contato, descricao })
          });

          if (response.ok) {
            alert('‚úÖ Pet criado com sucesso!');
            fecharModalPet();
            await carregarTodosDados();
          } else {
            alert('‚ùå Erro ao criar pet');
          }
        } catch (error) {
          console.error('Erro:', error);
          alert('Erro: ' + error.message);
        }
      }

      // Deletar Usu√°rio
      async function deletarUsuario(id) {
        if (!confirm('Tem certeza que deseja deletar este usu√°rio?')) return;

        try {
          const response = await fetch(`http://localhost:3000/usuarios/${id}`, {
            method: 'DELETE'
          });

          if (response.ok) {
            alert('‚úÖ Usu√°rio deletado com sucesso!');
            await carregarTodosDados();
          } else {
            alert('‚ùå Erro ao deletar usu√°rio');
          }
        } catch (error) {
          console.error('Erro:', error);
          alert('Erro: ' + error.message);
        }
      }

      // Deletar Pet
      async function deletarPet(id) {
        if (!confirm('Tem certeza que deseja deletar este pet?')) return;

        try {
          const response = await fetch(`http://localhost:3000/pets/${id}`, {
            method: 'DELETE'
          });

          if (response.ok) {
            alert('‚úÖ Pet deletado com sucesso!');
            await carregarTodosDados();
          } else {
            alert('‚ùå Erro ao deletar pet');
          }
        } catch (error) {
          console.error('Erro:', error);
          alert('Erro: ' + error.message);
        }
      }

      // Deletar Ado√ß√£o
      async function deletarAdocao(id) {
        if (!confirm('Tem certeza que deseja deletar esta ado√ß√£o?')) return;

        try {
          const response = await fetch(`http://localhost:3000/adocoes/${id}`, {
            method: 'DELETE'
          });

          if (response.ok) {
            alert('‚úÖ Ado√ß√£o deletada com sucesso!');
            await carregarTodosDados();
          } else {
            alert('‚ùå Erro ao deletar ado√ß√£o');
          }
        } catch (error) {
          console.error('Erro:', error);
          alert('Erro: ' + error.message);
        }
      }

      // Deletar Doa√ß√£o
      async function deletarDoacao(id) {
        if (!confirm('Tem certeza que deseja deletar esta doa√ß√£o?')) return;

        try {
          const response = await fetch(`http://localhost:3000/doacoes/${id}`, {
            method: 'DELETE'
          });

          if (response.ok) {
            alert('‚úÖ Doa√ß√£o deletada com sucesso!');
            await carregarTodosDados();
          } else {
            alert('‚ùå Erro ao deletar doa√ß√£o');
          }
        } catch (error) {
          console.error('Erro:', error);
          alert('Erro: ' + error.message);
        }
      }

      // Ver Detalhes
      function verDetalhesAdocao(id) {
        alert('Funcionalidade de detalhes em constru√ß√£o');
      }

      function verDetalhesDoacao(id) {
        alert('Funcionalidade de detalhes em constru√ß√£o');
      }

      // Editar (stubs para expans√£o futura)
      function editarUsuario(id) {
        alert('Funcionalidade de edi√ß√£o em constru√ß√£o');
      }

      function editarPet(id) {
        alert('Funcionalidade de edi√ß√£o em constru√ß√£o');
      }

      // Logout
      function fazerLogout() {
        if (confirm('Deseja realmente sair?')) {
          localStorage.removeItem('usuarioLogado');
          window.location.href = 'login.html';
        }
      }

      // Alternar Abas
      function mostrarAba(abaId) {
        // Esconder todas as abas
        document.querySelectorAll('.tab-content').forEach(aba => {
          aba.classList.remove('active');
        });

        // Remover active dos bot√µes
        document.querySelectorAll('.tab-btn').forEach(btn => {
          btn.classList.remove('active');
          btn.setAttribute('aria-selected', 'false');
        });

        // Mostrar aba selecionada
        const abaElement = document.getElementById(abaId);
        if (abaElement) {
          abaElement.classList.add('active');
        }

        // Marcar bot√£o como ativo
        event.target.classList.add('active');
        event.target.setAttribute('aria-selected', 'true');
      }

      // Carregar ao iniciar
      document.addEventListener('DOMContentLoaded', verificarAdmin);
    </script>
  </body>
</html>
